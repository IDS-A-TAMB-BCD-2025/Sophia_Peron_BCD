USE BD_SUPERMERCADO_FUNCIONARIO_PRODUTO_CONSUMIDOR;


INSERT INTO SUPERMERCADO(SUP_CNPJ, SUP_RAZAO_SOCIAL, SUP_TELEFONE, SUP_EMAIL, SUP_ENDERECO_LOGRADOURO, SUP_ENDERECO_NUMERO, SUP_ENDERECO_CIDADE, SUP_ENDERECO_ESTADO)
VALUES ("12345678000101", "Supermercado Grick", "19999999999","gricktambau@email.com", "Grick Street", "10000","TambaCity", "SP");

iNSERT INTO SUPERMERCADO(SUP_CNPJ, SUP_RAZAO_SOCIAL, SUP_TELEFONE, SUP_EMAIL, SUP_ENDERECO_LOGRADOURO, SUP_ENDERECO_NUMERO, SUP_ENDERECO_CIDADE, SUP_ENDERECO_ESTADO)
VALUES ('98765432000199', 'A Economia Distribuidora de Alimentos',"19999999998", 'aeconomia@email.com', 'Avenida Central', 250, 'São Paulo', 'SP');

INSERT INTO SUPERMERCADO(SUP_CNPJ, SUP_RAZAO_SOCIAL, SUP_TELEFONE, SUP_EMAIL, SUP_ENDERECO_LOGRADOURO, SUP_ENDERECO_NUMERO, SUP_ENDERECO_CIDADE, SUP_ENDERECO_ESTADO)
VALUES ('11223344000155', 'Preço Justo Supermercados S.A.', "19988889", 'contato@precojusto.com', 'Rua das Flores', 15, 'Campinas', 'SP');

INSERT INTO SUPERMERCADO(SUP_CNPJ, SUP_RAZAO_SOCIAL, SUP_TELEFONE, SUP_EMAIL, SUP_ENDERECO_LOGRADOURO, SUP_ENDERECO_NUMERO, SUP_ENDERECO_CIDADE, SUP_ENDERECO_ESTADO)
VALUES ('66778899000100', 'Distribuidora Bom Dia LTDA', "19949383929", 'bomdia@email.com.br', 'Travessa da Saudade', 789, 'Ribeirão Preto', 'SP');

INSERT INTO SUPERMERCADO(SUP_CNPJ, SUP_RAZAO_SOCIAL, SUP_TELEFONE, SUP_EMAIL, SUP_ENDERECO_LOGRADOURO, SUP_ENDERECO_NUMERO, SUP_ENDERECO_CIDADE, SUP_ENDERECO_ESTADO)
VALUES ('54321098000122', 'Mega Desconto de Alimentos', "1999569999", 'sac@megadesconto.net', 'Estrada Velha', 3000, 'Guarulhos', 'SP');

SELECT *FROM SUPERMERCADO;

INSERT INTO PRODUTO(PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES ("242424435", "Arroz 5KG", 5, 500, 26.90, "2025-12-25");

INSERT INTO PRODUTO(PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES ('7891234567890', 'Café Extra Forte 500g', 0.5, 1200, 15.50, '2026-06-10');

INSERT INTO PRODUTO(PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES ('0011223344556', 'Óleo de Soja 900ml', 0.9, 850, 7.99, '2025-08-01');

iNSERT INTO PRODUTO(PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES ('9988776655443', 'Leite Integral UHT 1L', 1.0, 3000, 5.25, '2025-04-20');

INSERT INTO PRODUTO(PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES ('1357924680011', 'Macarrão Espaguete 500g', 0.5, 1500, 4.30, '2027-01-15');

SELECT *FROM PRODUTO;

INSERT INTO CONSUMIDOR( CON_CPF, CON_NOME, CON_TELEFONE, CON_EMAIL)
VALUES("45494721892", "Livia Bispo", "1998736272", "liviabbispo@gmail.com");

INSERT INTO CONSUMIDOR(CON_CPF, CON_NOME, CON_TELEFONE, CON_EMAIL)
VALUES('12345678901', 'João Silva', '11987654321', 'joao.silva@outlook.com');

INSERT INTO CONSUMIDOR(CON_CPF, CON_NOME, CON_TELEFONE, CON_EMAIL)
VALUES('98765432109', 'Mariana Costa Santos', '21912345678', 'mariana.cs@email.com');

INSERT INTO CONSUMIDOR(CON_CPF, CON_NOME, CON_TELEFONE, CON_EMAIL)
VALUES('44455566677', 'Pedro Almeida', '31900001111', 'pedro.a@uol.com.br');

INSERT INTO CONSUMIDOR(CON_CPF, CON_NOME, CON_TELEFONE, CON_EMAIL)
VALUES('00011122233', 'Sofia Mendes', '81955554444', 'sofia_mendes@corp.com');


SELECT *FROM CONSUMIDOR;

INSERT INTO FUNCIONARIO( FUN_CPF, FUN_NOME, FUN_DATA_NASCIMENTO, FUN_TELEFONE, FUN_EMAIL, FUN_CARTEIRA_TRABALHO, FUN_BANCO_AGENCIA, FUN_BANCO_CONTA, FUN_DATdA_ADMISSAO, FUN_JORNADA_TRABALHO, FK_SUP_CNPJ)
VALUES("9875432100", "José Vanderlei", "1985-03-12", "1198709817", "ze_varnderlei@email.com", "carteira_ze_vanderlei.pdf", "1234", "56789", "2020-01-15", "44 horas", "12345678000101");

INSERT INTO FUNCIONARIO(FUN_CPF, FUN_NOME, FUN_DATA_NASCIMENTO, FUN_TELEFONE, FUN_EMAIL, FUN_CARTEIRA_TRABALHO, FUN_BANCO_AGENCIA, FUN_BANCO_CONTA, FUN_DATdA_ADMISSAO, FUN_JORNADA_TRABALHO, FK_SUP_CNPJ)
VALUES('11122233344', 'Ana Paula de Souza', '1995-10-20', '11998765432', 'ana.souza@supergrick.com', 'CTPS-11122233344', '0001', '101010', '2022-05-10', '40 horas', '12345678000101');

INSERT INTO FUNCIONARIO(FUN_CPF, FUN_NOME, FUN_DATA_NASCIMENTO, FUN_TELEFONE, FUN_EMAIL, FUN_CARTEIRA_TRABALHO, FUN_BANCO_AGENCIA, FUN_BANCO_CONTA, FUN_DATdA_ADMISSAO, FUN_JORNADA_TRABALHO, FK_SUP_CNPJ)
VALUES('55566677788', 'Carlos Eduardo Lima', '1978-01-05', '19912345678', 'carlos.lima@supergrick.com', 'CTPS-55566677788', '4321', '98765', '2019-11-20', '44 horas', '12345678000101');

INSERT INTO FUNCIONARIO(FUN_CPF, FUN_NOME, FUN_DATA_NASCIMENTO, FUN_TELEFONE, FUN_EMAIL, FUN_CARTEIRA_TRABALHO, FUN_BANCO_AGENCIA, FUN_BANCO_CONTA, FUN_DATdA_ADMISSAO, FUN_JORNADA_TRABALHO, FK_SUP_CNPJ)
VALUES('99900011122', 'Fernanda Rocha', '2000-07-28', '11955554444', 'fernanda.r@supergrick.com', 'CTPS-99900011122', '0101', '123456', '2023-08-01', '30 horas', '12345678000101');

INSERT INTO FUNCIONARIO(FUN_CPF, FUN_NOME, FUN_DATA_NASCIMENTO, FUN_TELEFONE, FUN_EMAIL, FUN_CARTEIRA_TRABALHO, FUN_BANCO_AGENCIA, FUN_BANCO_CONTA, FUN_DATdA_ADMISSAO, FUN_JORNADA_TRABALHO, FK_SUP_CNPJ)
VALUES('32165498700', 'Gabriel Mendes', '1990-04-01', '11944443333', 'gabriel.m@aeconomia.com', 'CTPS-32165498700', '7777', '112233', '2021-03-05', '40 horas', '98765432000199');


SELECT *FROM FUNCIONARIO;

-- Supermercado Grick (12345678000101) vende Arroz (ID 1)
INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES ('12345678000101', 1);

-- A Economia (98765432000199) vende Café (ID 2)
INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES ('98765432000199', 2);

-- Preço Justo (11223344000155) vende Óleo (ID 3)
INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES ('11223344000155', 3);

-- Distribuidora Bom Dia (66778899000100) vende Leite (ID 4)
INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES ('66778899000100', 4);

-- Supermercado Grick (12345678000101) vende Macarrão (ID 5)
INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES ('12345678000101', 5);

-- Livia Bispo (45494721892) comprou Arroz (ID 1)
INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES ('45494721892', 1);

-- João Silva (12345678901) comprou Café (ID 2)
INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES ('12345678901', 2);

-- Mariana Costa (98765432109) comprou Óleo (ID 3)
INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES ('98765432109', 3);

-- Pedro Almeida (44455566677) comprou Leite (ID 4)
INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES ('44455566677', 4);

-- Sofia Mendes (00011122233) comprou Macarrão (ID 5)
INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES ('00011122233', 5);



SELECT * FROM SUPERMERCADO;

/* CONSULTAR O AUMENTO DE R$ 2,00 NO PRECO DOS PRODUTOS COM PREÇO ATUAL >= R$ 5,0 */

SELECT PRO_NOME AS "NOME",
	PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
	PRO_PRECO AS "PREÇO ATUAL",
	TRUNCATE((PRO_PRECO +2),2) AS "PRECO COM AJUSTE DE R$ 2,00"
FROM PRODUTO 
WHERE PRO_PRECO >=5;

/*
CONSULTAR A REDUÇÃO DE R$ 1,00 NO PREÇO DOS PRODUTOS COM PREÇO ATUAL ABAIXO DE R$ 5,00
*/

SELECT PRO_NOME AS "NOME", PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS", PRO_PRECO AS "PRECO ATUAL", 
TRUNCATE ((PRO_PRECO - 1),2) AS "PREÇO COM REDUÇÃO DE R$1,00" 
FROM PRODUTO
WHERE PRO_PRECO <= 10;

/* CONSULTAR COMO SERIA APLICAR UM DESCONTO DE 10% EM TODOS OS PRODUTOS
*/

SELECT PRO_NOME AS "NOME", PRO_CODIGO_BARRAS AS "CÓDIGO_BARRAS", PRO_PRECO AS "PREÇO ATUAL", (PRO_PRECO - (PRO_PRECO * 0.1)) AS "PREÇO DESCONTO DE 10%"
FROM PRODUTO;

/* AJUSTAR O ESTOQUE DO PRIMEIRO PRODUTO, DIVIDINDO PELA METADE*/

SELECT PRO_ID, PRO_NOME, PRO_CODIGO_BARRAS, PRO_QUANTIDADE
FROM PRODUTO;

UPDATE PRODUTO
SET PRO_QUANTIDADE = PRO_QUANTIDADE/2
WHERE PRO_ID = 1;

/*CONSULTAR TODOS OS PRODUTOS QUE TENHAM DATA DE VALIDADE ENTRE SETEMBRO DE 2025 E DEZEMBRO DE 2025*/
SELECT PRO_NOME AS "NOME",
	PRO_NOME AS "CODIGO DE BARRAS",
    PRO_DATA_VALIDADE AS "DATA DE VALIDADE"
FROM PRODUTO 
WHERE PRO_DATA_VALIDADE BETWEEN '2025-09-01' AND '2025-12-31';

/*CONSULTAR TODOS OS PRODUTOS QUE TENHAM PREÇO MAIOR QUE 10 OU MENOR QUE 4*/
SELECT PRO_NOME AS "NOME",
	PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
    PRO_PRECO AS "PREÇO"
FROM PRODUTO 
WHERE PRO_PRECO >= 10 OR PRO_PRECO <= 4;

/*CONSULTAR OS DDD E TELEFONES DOS CONSUMIDORES SEPARADAMENTE*/
SELECT 	CON_NOME 					AS "NOME DO CONSUMIDOR",
		CON_CPF 					AS "CPF DO CONSUMIDOR",
		SUBSTRING(CON_TELEFONE,1,2) AS "DDD DO TELEFONE",
        SUBSTRING(CON_TELEFONE,3,9) AS "NUMERO DO TELEFONE"
FROM CONSUMIDOR;

/*GERAR UMA FRASE UMA FRASE CONCATENADO: RAZÃO SOCIAL, CNPJ, TELEFONE E EMAIL*/
SELECT 	CONCAT("Razão social", SUP_RAZAO_SOCIAL,
			CONCAT("| CNPJ:",
				CONCAT(SUP_CNPJ,
					CONCAT(" | Telefone:",
						CONCAT(SUP_TELEFONE,
							CONCAT(" | Email:", SUP_EMAIL)))))) AS FRASE
FROM SUPERMERCADO;

/* GERAR UMA CONSULTA QUE VERIFICA O STATUS DO PESO DOS PRODUTOS
REGRAS:
1) PESO <=5: PESO BAIXO
2) PESO > 5 E QUANTIDADE <=100: ESTOQUE MÉDIO
3) PESO >= 50: ESTOQUE ALTO*/
SELECT PRO_NOME AS "NOME DO PRODUTO",
	PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
    PRO_QUANTIDADE AS "QUANTIDADE",
    PRO_DATA_VALIDADE AS "DATA DE VALIIDADE",
    PRO_PESO AS "PESO DO PRODUTO",
    CASE
		WHEN PRO_PESO <= 5 THEN "PESO BAIXO"
        WHEN PRO_PESO > 5 AND PRO_PESO <= 50 THEN "PESO MÉDIO"
        WHEN PRO_PESO > 50 THEN "PESO ALTO"
	END AS "CLASSIFICAÇÃO DO PESO"
FROM PRODUTO;

/*CONTAR QUANTOS CONSUMIDORES TEMOS CADASTRADO*/
SELECT COUNT(*)
FROM CONSUMIDOR;

/*CONTAR QUANTOS FUNCIONARIOS TEMOS CADASTRADO*/
SELECT COUNT(*)
FROM FUNCIONARIO;

/*CONTAR QUANTOS PRODUTOS TEMOS CADASTRADO*/
SELECT COUNT(*)
FROM PRODUTO;

/*SOMAR O PREÇO TOTAL DE TODOS OS PRODUTOS CADASTRADOS*/
SELECT SUM(PRO_PRECO)
FROM PRODUTO;

SELECT CONCAT("R$", TRUNCATE(SUM(PRO_PRECO),2)) AS "SOMA TOTAL"
FROM PRODUTO;

/*CALCULAR A MÉDIA DE PREÇOS DOS PRODUTOS*/
SELECT AVG(PRO_PRECO) 
FROM PRODUTO;

SELECT CONCAT("R$", TRUNCATE(AVG(PRO_PRECO),2)) AS "MÉDIA DE PREÇO"
FROM PRODUTO;

/*SELECIONAR O PRODUTO MAIS CARO*/
SELECT MAX(PRO_PRECO)
FROM PRODUTO;

/*SELECIONAR O ESTOQUE COM MAIOR QUANTIDADE*/
SELECT MAX(PRO_QUANTIDADE)
FROM PRODUTO;

/*SELECIONAR O PRODUTO MAIS BARATO*/
SELECT MIN(PRO_PRECO)
FROM PRODUTO;


/*SELECIONAR O MENOR ESTOQUE*/
SELECT MIN(PRO_QUANTIDADE)
FROM PRODUTO;

/* SELECIONAR A DATA E HORA ATUAL*/
SELECT NOW() 
FROM DUAL;

SELECT FUN_NOME AS "NOME DO FUNCIONARIO",
		DATE_FORMAT(FUN_DATA_NASCIMENTO, "%d/%m/%Y") AS "DATA DE NASCIMENTO",
        TIMESTAMPDIFF(YEAR, FUN_DATA_NASCIMENTO,NOW()) AS "IDADE"
FROM FUNCIONARIO;

/*FUNÇÕES MATEMÁTICAS:
VALOR - ABSOLUTO DE UM NÚMERO
ROUND - ARREDONDAR
POWER - POTÊNCIA*/
SELECT ABS(-10),
	ROUND(PRO_PRECO) AS "PREÇO ARREDONDADO",
    POWER(PRO_PRECO,2) AS "PREÇOS ELEVADOS AO QUADRADO"
FROM PRODUTO;

/*UPPER. LOWER, TRIM*/
SELECT 	UPPER(FUN_NOME) AS "MAIÚSCULAS",
		LOWER(FUN_NOME) AS "MINÚSCULAS",
		TRIM("            Sophia") AS "TIRANDO ESPAÇOS"
FROM FUNCIONARIO;
        